using AutoMapper;
using Microsoft.EntityFrameworkCore;
using Owlvey.Falcon.Core.Entities;
using Owlvey.Falcon.Gateways;
using Owlvey.Falcon.Models;
using Owlvey.Falcon.Repositories;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Owlvey.Falcon.Components
{
    public class SecurityRiskComponent: BaseComponent
    {
        public static void ConfigureMappers(IMapperConfigurationExpression cfg)
        {
            cfg.CreateMap<SecurityRiskEntity, SecurityRiskGetRp>()
                .ForMember(c=>c.Source, c=>c.MapFrom(d=> d.Source != null? d.Source.Name : ""));
            cfg.CreateMap<SecurityThreatEntity, SecurityThreatGetRp>();
            
        }

        private readonly FalconDbContext _dbContext;

        public SecurityRiskComponent(FalconDbContext dbContext,
            IUserIdentityGateway identityGateway, IDateTimeGateway dateTimeGateway,
            IMapper mapper, ConfigurationComponent configuration) : base(dateTimeGateway, mapper, identityGateway, configuration)
        {
            this._dbContext = dbContext;
        }

        public async Task<IEnumerable<SecurityRiskGetRp>> GetRisks(int? sourceId) {
            if (sourceId.HasValue)
            {
                var response = await this._dbContext.SecurityRisks.Include(c=>c.Source)
                    .Where(c => c.SourceId == sourceId).ToListAsync();
                return this._mapper.Map<IEnumerable<SecurityRiskGetRp>>(response);
            }
            else {
                var response = await this._dbContext.SecurityRisks.Include(c=>c.Source).ToListAsync();
                return this._mapper.Map<IEnumerable<SecurityRiskGetRp>>(response);
            }
            
        }
        public async Task<SecurityRiskGetRp> GetRiskById(int id)
        {
            var response = await this._dbContext.SecurityRisks
                .Include(c=>c.Source)
                .Where(c => c.Id == id).SingleOrDefaultAsync();
            return this._mapper.Map<SecurityRiskGetRp>(response);
        }
        public async Task<SecurityRiskGetRp> Create(SecurityRiskPost model)
        {
            var modifiedBy = this._identityGateway.GetIdentity();
            var modifiedOn = this._datetimeGateway.GetCurrentDateTime();
            var item = SecurityRiskEntity.Factory.Create(
                model.SourceId,                 
                modifiedOn, modifiedBy, model.Name,
                model.Description, model.Tags, model.Reference, model.Avatar, 
                model.AgentSkillLevel, model.Motive, model.Opportunity, model.Size
                , model.EasyDiscovery, model.EasyExploit, model.Awareness, model.IntrusionDetection, 
                model.LossConfidentiality, model.LossIntegrity, model.LossAvailability, model.LossAccountability, model.FinancialDamage,
                model.ReputationDamage, model.NonCompliance, model.PrivacyViolation);

            this._dbContext.SecurityRisks.Add(item);
            await this._dbContext.SaveChangesAsync();
            return this._mapper.Map<SecurityRiskGetRp>(item);
        }
        public async Task<SecurityRiskGetRp> UpdateRisk(int id, SecurityRiskPut model)
        {
            var modifiedBy = this._identityGateway.GetIdentity();
            var modifiedOn = this._datetimeGateway.GetCurrentDateTime();
            this._dbContext.ChangeTracker.AutoDetectChangesEnabled = true;
            
            var item = this._dbContext.SecurityRisks.Where(c => c.Id == id).SingleOrDefault();
            if (item != null) {

                item.Update(modifiedOn, modifiedBy, model.Name, model.Description, model.Tags, model.Reference, model.AgentSkillLevel,
                    model.Motive, model.Opportunity, model.Size, model.EasyDiscovery, model.EasyExploit, model.Awareness, model.IntrusionDetection, model.LossConfidentiality, model.LossIntegrity, model.LossAvailability, model.LossAccountability, model.FinancialDamage, model.ReputationDamage, model.NonCompliance, model.PrivacyViolation);
                this._dbContext.SecurityRisks.Update(item);
                await this._dbContext.SaveChangesAsync();
            }
            return this._mapper.Map<SecurityRiskGetRp>(item);
        }
        public async Task DeleteRisk(int id)
        {
            var item = this._dbContext.SecurityRisks.Where(c => c.Id == id).SingleOrDefault();
            if (item != null)
            {
                this._dbContext.SecurityRisks.Remove(item);
                await this._dbContext.SaveChangesAsync();
            }            
        }

        public async Task<IEnumerable<SecurityThreatGetRp>> GetThreats()
        {
            var items = await  this._dbContext.SecurityThreats.ToListAsync();
            var result = this._mapper.Map<IEnumerable<SecurityThreatGetRp>>(items);
            return result;
        }
        public async Task<SecurityThreatGetRp> GetThreat(int id)
        {
            var item = await this._dbContext.SecurityThreats.Where(c => c.Id == id).SingleOrDefaultAsync();
            return this._mapper.Map<SecurityThreatGetRp>(item);
        }
        public async Task<IEnumerable<SecurityThreatGetRp>> CreateDefault()
        {            
            var result = new List<SecurityThreatGetRp>();
            var spoofingCreated = await this.CreateThreat( new SecurityThreatPostRp(){
                Name = "Spoofing"
            });
            result.Add(await this.UpdateThreat(spoofingCreated.Id, new SecurityThreatPutRp() { 
                Description = "spoofing attack is a situation in which a person or program successfully identifies as another by falsifying data, to gain an illegitimate advantage",
                Avatar = "data:image/png;base64,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",
                Tags = "#spoofing", 
                AgentSkillLevel = 3, FinancialDamage = 3, ReputationDamage = 4, NonCompliance = 5,
                PrivacyViolation = 3,
                Reference = "https://en.wikipedia.org/wiki/Spoofing_attack"  
            }));

            var tampering = await this.CreateThreat( new SecurityThreatPostRp(){
                                Name = "Tampering"}); 
            result.Add(await this.UpdateThreat( tampering.Id, new SecurityThreatPutRp(){
                Description = "Refer to many forms of sabotage but the term is often used to mean intentional modification of products in a way that would make them harmful to the consumer.",
                Avatar = "data:image/png;base64,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",
                Tags = "#tampering", 
                AgentSkillLevel = 3, FinancialDamage = 3, ReputationDamage = 4, NonCompliance = 5,
                PrivacyViolation = 3,
                Reference = "https://en.wikipedia.org/wiki/Tampering_(crime)"              
            }));
            
            var repudation = await this.CreateThreat( new SecurityThreatPostRp(){
                            Name = "Repudation"}); 

            result.Add(await this.UpdateThreat( repudation.Id, new SecurityThreatPutRp(){
                Description = "Non-repudiation refers to a situation where a statement's author cannot successfully dispute its authorship or the validity of an associated contract.",
                Avatar = "data:image/jpeg;base64,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",
                Tags = "#repudation", 
                AgentSkillLevel = 3, FinancialDamage = 3, ReputationDamage = 4, NonCompliance = 5,
                PrivacyViolation = 3,
                Reference = "https://en.wikipedia.org/wiki/Non-repudiation"  
            
            }));

            var information = await this.CreateThreat( new SecurityThreatPostRp(){
                            Name = "Information disclosure"}); 

            result.Add(await this.UpdateThreat( information.Id, new SecurityThreatPutRp(){
                Description = "A data breach is the intentional or unintentional release of secure or private/confidential information to an untrusted environment. ",
                Avatar = "data:image/jpeg;base64,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",
                Tags = "#disclosure", 
                AgentSkillLevel = 3, FinancialDamage = 3, ReputationDamage = 4, NonCompliance = 5,
                PrivacyViolation = 3,
                Reference = "https://en.wikipedia.org/wiki/Information_privacy"  
            }));

            var denied = await this.CreateThreat( new SecurityThreatPostRp(){
                            Name = "Denied of Service"});

            result.Add(await this.UpdateThreat( denied.Id, new SecurityThreatPutRp(){
                Description = "Denial of service is typically accomplished by flooding the targeted machine or resource with superfluous requests in an attempt to overload systems and prevent some or all legitimate requests from being fulfilled",
                Avatar = "data:image/png;base64,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",
                Tags = "#DoS", 
                AgentSkillLevel = 3, FinancialDamage = 3, ReputationDamage = 4, NonCompliance = 5,
                PrivacyViolation = 3,
                Reference = "https://en.wikipedia.org/wiki/Denial-of-service_attack"  
            }));
            var elevation = await this.CreateThreat( new SecurityThreatPostRp(){
                            Name = "Elevation of privilege"});
            
            result.Add(await this.UpdateThreat( elevation.Id, new SecurityThreatPutRp(){
                Description = "act of exploiting a bug, design flaw or configuration oversight in an operating system or software application to gain elevated access to resources that are normally protected from an application or user.",
                Avatar = "data:image/jpeg;base64,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",
                Tags = "#elevation", 
                AgentSkillLevel = 3, FinancialDamage = 3, ReputationDamage = 4, NonCompliance = 5,
                PrivacyViolation = 3,
                Reference = "https://en.wikipedia.org/wiki/Privilege_escalation"  
            }));
            return result;
        }
        public async Task<SecurityThreatGetRp> CreateThreat(SecurityThreatPostRp model) {
            var modifiedBy = this._identityGateway.GetIdentity();
            var modifiedOn = this._datetimeGateway.GetCurrentDateTime();
            var exists = await this._dbContext.SecurityThreats.Where(c => c.Name == model.Name).SingleOrDefaultAsync();
            if (exists == null) {
                exists = SecurityThreatEntity.Create(model.Name, modifiedBy, modifiedOn);
                this._dbContext.Add(exists);
                await this._dbContext.SaveChangesAsync();
            }
            return this._mapper.Map<SecurityThreatGetRp>(exists);
        }
        public async Task<SecurityThreatGetRp> UpdateThreat(int id, SecurityThreatPutRp model)
        {
            var modifiedBy = this._identityGateway.GetIdentity();
            var modifiedOn = this._datetimeGateway.GetCurrentDateTime();
            this._dbContext.ChangeTracker.AutoDetectChangesEnabled = true;

            var item = this._dbContext.SecurityThreats.Where(c => c.Id == id).SingleOrDefault();
            if (item != null)
            {
                item.Update(modifiedOn, modifiedBy, model.Name, model.Avatar,
                    model.Description, model.Tags,
                    model.Reference, model.AgentSkillLevel, model.Motive, model.Opportunity, model.Size,
                    model.EasyDiscovery, model.EasyExploit, model.Awareness, model.IntrusionDetection, model.LossConfidentiality, model.LossIntegrity, 
                    model.LossAccountability, model.LossAccountability, model.FinancialDamage, model.ReputationDamage, model.NonCompliance, model.PrivacyViolation);
                this._dbContext.SecurityThreats.Update(item);
                await this._dbContext.SaveChangesAsync();
            }
            return this._mapper.Map<SecurityThreatGetRp>(item);
        }
        public async Task DeleteThreat(int id)
        {
            var item = this._dbContext.SecurityThreats.Where(c => c.Id == id).SingleOrDefault();
            if (item != null)
            {
                this._dbContext.SecurityThreats.Remove(item);
                await this._dbContext.SaveChangesAsync();
            }
        }
    }
}
